<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header(title='Your Orders')}">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-green-100 min-h-screen text-gray-900">

    <!-- Navbar -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <!-- Main Content -->
    <main class="p-8">
        <h1 class="text-3xl font-bold text-center mb-8 text-green-800">Your Orders</h1>

        <!-- Message -->
        <div th:if="${message}" class="bg-green-600 text-white text-center py-4 rounded mb-6">
            <p th:text="${message}"></p>
        </div>

        <div th:unless="${message}" class="space-y-6">
            <div th:each="order : ${orders}" class="bg-white rounded-lg shadow-lg p-6">

                <!-- Card Header -->
                <div class="bg-green-600 text-white rounded-t-lg p-3 mb-4">
                    <p class="font-bold text-lg">Order ID: <span th:text="${order.orderId}"></span></p>
                </div>

                <!-- Order Details -->
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                    <div class="space-y-1">
                        <p><span class="font-semibold">Date:</span> <span th:text="${order.dateOfOrder}"></span></p>
                        <p><span class="font-semibold">Processed By:</span> 
                            <span th:text="${order.processorEmployee != null ? order.processorEmployee.firstName + ' ' + order.processorEmployee.lastName : 'N/A'}"></span>
                        </p>
                        <p><span class="font-semibold">Payment Method:</span> <span th:text="${order.paymentMethod}"></span></p>
                    </div>

                    <!-- Status Buttons -->
                    <div class="flex flex-col md:flex-row gap-2 mt-2 md:mt-0">
                        <div th:if="${customerOrderStatusMap[order.orderId] != 'CANCELLED'}">
                            <a th:href="@{/return-order/{id}(id=${order.orderId})}" class="px-4 py-2 bg-yellow-500 text-gray-900 rounded hover:bg-yellow-400 transition text-center">Return</a>
                        </div>
                        <div th:if="${customerOrderStatusMap[order.orderId] == 'CANCELLED'}">
                            <span class="px-3 py-1 bg-red-600 rounded font-bold text-white">Cancelled</span>
                        </div>
                        <div th:if="${customerOrderStatusMap[order.orderId] == 'DELIVERED'}">
                            <span class="px-3 py-1 bg-green-600 rounded font-bold text-white">Delivered</span>
                        </div>
                        <div th:if="${customerOrderStatusMap[order.orderId] == 'SHIPPED'}">
                            <span class="px-3 py-1 bg-blue-500 rounded font-bold text-white">Shipped</span>
                        </div>
                    </div>
                </div>

                <!-- Products -->
                <div>
                    <p class="font-semibold mb-2">Products:</p>
                    <ul class="list-disc list-inside space-y-1 text-gray-700">
                        <li th:each="product : ${order.products}" th:text="${product.first.productName + ' (Qty: ' + product.second + ')'}"></li>
                    </ul>
                </div>

            </div>
        </div>
    </main>
</body>
</html>
